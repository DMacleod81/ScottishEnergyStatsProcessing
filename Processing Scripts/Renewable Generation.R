library(readxl)
library(plyr)
library(dplyr)
library(tidyverse)
library(magrittr)

Renewable_Generation <- read_excel("Data Sources/Renewable Generation/Renewable Generation.xls", 
                                   sheet = "Generation & Supply", col_names = FALSE)

Renewable_Generation  <- as.data.frame(t(Renewable_Generation))
Renewable_Generation  <- Renewable_Generation [c(2,3,4,5,6,8,9,10,11,13,14,15,17,18,19,21,22,23,25,27)]

names(Renewable_Generation ) <- c("Year", 
              "Country", 
              "Electricity generated by major power producers",
              "Electricity generated by other generators",
              "Total generated",
              "Own use by Other generators",
              "Electricity supplied (net) by Other generators",
              "Used in pumping at pumped storage and other own use by MPPs",
              "Electricity supplied (net) by MPPs",
              "Electricity transferred to England (net of receipts)",
              "Electricity transferred to Northern Ireland (net of receipts)",
              "Electricity transferred to Europe (net of receipts)",
              "Transfers from other generators to public supply",
              "Transmission losses",
              "Distribution losses and theft",
              "Consumption from public supply",
              "Consumption by autogenerators",
              "Total electricity consumption",
              "Electricity sales (public supply)",
              "Statistical difference"
              )

Renewable_Generation <- fill(Renewable_Generation, Year, .direction = "down")

Renewable_Generation <- Renewable_Generation[complete.cases(Renewable_Generation),]

Renewable_Generation$Country <- as.character(Renewable_Generation$Country)

Renewable_Generation[c(1,3:20)] %<>% lapply(function(x) as.numeric(as.character(x)))

Renewable_Generation <- as.data.frame(Renewable_Generation)

write.table(Renewable_Generation,
            "Output/Renewable Generation/GenSupplyReadable.txt",
            sep = "\t",
            row.names = FALSE)

